Module("runtime/editor/positions",[Signature([Constructors([OpDecl("MARKER",ConstType(SortNoArgs("Term")))])]),Strategies([RDefT("desugar-position",[DefaultVarDec("desugar")],[DefaultVarDec("ast")],Rule(Var("position"),Var("position'"),Seq(Assign(Var("ast'"),App(CallT(SVar("at-position"),[Build(AnnoList(RootApp(Id),[NoAnnoList(Op("MARKER",[]))]))],[Var("position")]),Var("ast"))),Seq(Assign(Var("ast''"),App(Call(SVar("topdown"),[Call(SVar("repeat"),[Call(SVar("preserve-annos"),[ScopeDefault(Seq(Match(Var("x")),Seq(CallNoArgs(SVar("desugar")),Not(Match(Var("x"))))))])])]),Var("ast'"))),Assign(Var("position'"),App(Call(SVar("position-of-term"),[ScopeDefault(Seq(Match(AnnoList(Wld,[Var(ListVar("a*"))])),BA(One(Match(NoAnnoList(Op("MARKER",[])))),Var(ListVar("a*")))))]),Var("ast''"))))))),RDefT("at-position",[DefaultVarDec("s")],[DefaultVarDec("position")],Rule(NoAnnoList(Explode(Var("c"),Var(ListVar("t*")))),Var("t'"),[WhereClause(AM(Build(Var("position")),NoAnnoList(ListTail([Var("i")],Var("position'"))))),WhereClause(Assign(Var("t'"),NoAnnoList(Explode(Var("c"),App(Call(SVar("at-index"),[CallT(SVar("at-position"),[CallNoArgs(SVar("s"))],[Var("position'")])]),NoAnnoList(Tuple([Var("i"),Var(ListVar("t*"))])))))))])),RDefT("at-position",[DefaultVarDec("s")],[DefaultVarDec("position")],Rule(Var("t"),Var("t'"),Seq(AM(Build(Var("position")),NoAnnoList(List([]))),Assign(Var("t'"),App(CallNoArgs(SVar("s")),Var("t")))))),RDef("position-of-term",[DefaultVarDec("is-term")],Rule(Var("t"),NoAnnoList(List([])),CallNoArgs(SVar("is-term")))),RDef("position-of-term",[DefaultVarDec("is-term")],Rule(NoAnnoList(Explode(Wld,Var(ListVar("t*")))),App(CallT(SVar("position-of-term"),[CallNoArgs(SVar("is-term"))],[NoAnnoList(Int("0"))]),Var(ListVar("t*"))),Not(CallNoArgs(SVar("is-term"))))),RDefT("position-of-term",[DefaultVarDec("is-term")],[DefaultVarDec("start-index")],Rule(NoAnnoList(ListTail([Var("t")],Var(ListVar("t*")))),Var("position"),CondChoice(Assign(Var(ListVar("i*")),App(Call(SVar("position-of-term"),[CallNoArgs(SVar("is-term"))]),Var("t"))),Assign(Var("position"),NoAnnoList(ListTail([Var("start-index")],Var(ListVar("i*"))))),Assign(Var("position"),App(CallT(SVar("position-of-term"),[CallNoArgs(SVar("is-term"))],[App(CallNoArgs(SVar("inc")),Var("start-index"))]),Var(ListVar("t*"))))))),RDefT("term-at-position",[],[DefaultVarDec("position")],Rule(Var("t"),Var("t'"),CallT(SVar("at-position"),[Match(Var("t'"))],[Var("position")]))),RDefT("parent-at-position",[],[DefaultVarDec("position")],Rule(Var("t"),Var("t'"),Seq(AM(Build(Var("position")),NoAnnoList(List([Var("i"),Wld]))),Assign(Var("t'"),App(CallT(SVar("subterm-at"),[],[Var("i")]),Var("t")))))),RDefT("parent-at-position",[],[DefaultVarDec("position")],Rule(Var("t"),App(CallT(SVar("parent-at-position"),[],[Var("position'")]),Var("t'")),Seq(AM(Build(Var("position")),NoAnnoList(ListTail([Var("i")],As(Var("position'"),NoAnnoList(ListTail([Wld,Wld],Wld)))))),Assign(Var("t'"),App(CallT(SVar("subterm-at"),[],[Var("i")]),Var("t")))))),RDefT("subterm-at",[],[DefaultVarDec("index")],RuleNoCond(NoAnnoList(Explode(Wld,Var(ListVar("t*")))),App(CallT(SVar("index"),[],[App(CallNoArgs(SVar("inc")),Var("index"))]),Var(ListVar("t*")))))])])