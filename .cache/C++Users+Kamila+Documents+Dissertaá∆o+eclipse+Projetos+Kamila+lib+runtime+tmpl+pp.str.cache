Module("runtime/tmpl/pp",[Imports([Import("libstratego-lib"),Import("libstratego-gpp")]),Signature([Constructors([OpDecl("Parenthetical",FunType([ConstType(SortNoArgs("Unknown"))],ConstType(SortNoArgs("Unknown"))))])]),Strategies([SDef("pp-one",[DefaultVarDec("pp")],Seq(LChoice(CallNoArgs(SVar("pp")),Match(NoAnnoList(Op("Parenthetical",[RootApp(CallNoArgs(SVar("pp")))])))),Call(SVar("filter"),[CallNoArgs(SVar("gpp-is-real-vbox"))]))),SDef("pp-one-V",[DefaultVarDec("pp")],Seq(Call(SVar("pp-one"),[CallNoArgs(SVar("pp"))]),LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("V",[NoAnnoList(List([])),RootApp(Id)])))))),SDef("pp-one-Z",[DefaultVarDec("pp")],Seq(Call(SVar("pp-one"),[CallNoArgs(SVar("pp"))]),LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("Z",[NoAnnoList(List([])),RootApp(Id)])))))),SDef("pp-option",[DefaultVarDec("pp")],Choice(LRule(RuleNoCond(NoAnnoList(Op("None",[])),NoAnnoList(List([])))),Match(NoAnnoList(Op("Some",[RootApp(CallNoArgs(SVar("pp")))]))))),SDef("pp-V-list",[DefaultVarDec("pp")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("V",[NoAnnoList(List([])),RootApp(Call(SVar("map"),[Call(SVar("pp-one-V"),[CallNoArgs(SVar("pp"))])]))]))))),SDefT("pp-V-list",[DefaultVarDec("pp")],[DefaultVarDec("vs")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("V",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("VS",[])),Var("vs")]))])),RootApp(Call(SVar("map"),[Call(SVar("pp-one-V"),[CallNoArgs(SVar("pp"))])]))]))))),SDefT("pp-V-list",[DefaultVarDec("pp")],[DefaultVarDec("vs"),DefaultVarDec("sep")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("V",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("VS",[])),Var("vs")]))])),RootApp(Seq(Call(SVar("map"),[Call(SVar("pp-one-V"),[CallNoArgs(SVar("pp"))])]),Call(SVar("at-init"),[CallT(SVar("add-sep"),[],[Var("sep")]),Id])))]))))),SDefT("pp-indent",[],[DefaultVarDec("is")],Seq(Call(SVar("filter"),[CallNoArgs(SVar("gpp-is-real-vbox"))]),LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("I",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("IS",[])),Var("is")]))])),NoAnnoList(Op("H",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("\"0\""))]))])),RootApp(Id)]))])))))),SDef("pp-H-list",[DefaultVarDec("pp")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("H",[NoAnnoList(List([])),RootApp(Call(SVar("map"),[Call(SVar("pp-one-Z"),[CallNoArgs(SVar("pp"))])]))]))))),SDefT("pp-H-list",[DefaultVarDec("pp")],[DefaultVarDec("sep")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("H",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("\"0\""))]))])),RootApp(Seq(Call(SVar("map"),[Call(SVar("pp-one-Z"),[CallNoArgs(SVar("pp"))])]),CallT(SVar("separate-by"),[],[NoAnnoList(Op("S",[Var("sep")]))])))]))))),SDef("pp-HV-list",[DefaultVarDec("pp")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("HV",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("\"0\""))]))])),RootApp(Call(SVar("map"),[Call(SVar("pp-one-Z"),[CallNoArgs(SVar("pp"))])]))]))))),SDefT("pp-HV-list",[DefaultVarDec("pp")],[DefaultVarDec("sep")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("HV",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("\"0\""))]))])),RootApp(Seq(Call(SVar("map"),[Call(SVar("pp-one-Z"),[CallNoArgs(SVar("pp"))])]),CallT(SVar("separate-by"),[],[NoAnnoList(Op("S",[Var("sep")]))])))]))))),SDef("pp-HZ-list",[DefaultVarDec("pp")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("HZ",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("\"0\""))]))])),RootApp(Call(SVar("map"),[Call(SVar("pp-one-Z"),[CallNoArgs(SVar("pp"))])]))]))))),SDefT("pp-HZ-list",[DefaultVarDec("pp")],[DefaultVarDec("sep")],LChoice(Match(NoAnnoList(List([]))),Build(NoAnnoList(Op("HZ",[NoAnnoList(List([NoAnnoList(Op("SOpt",[NoAnnoList(Op("HS",[])),NoAnnoList(Str("\"0\""))]))])),RootApp(Seq(Call(SVar("map"),[Call(SVar("pp-one-Z"),[CallNoArgs(SVar("pp"))])]),CallT(SVar("separate-by"),[],[NoAnnoList(Op("S",[Var("sep")]))])))])))))]),Rules([RDefT("add-sep",[],[DefaultVarDec("sep")],Rule(NoAnnoList(Op("V",[Var("vs"),Var("boxes")])),NoAnnoList(Op("V",[Var("vs"),Var("result")])),CondChoice(Assign(NoAnnoList(List([Var("h")])),Var("boxes")),Seq(Assign(NoAnnoList(Tuple([Var("c"),NoAnnoList(List([Var("cs"),Var("inner-boxes")]))])),App(CallNoArgs(SVar("explode-term")),Var("h"))),Seq(Assign(Var("box-with-sep"),App(CallNoArgs(SVar("mkterm")),NoAnnoList(Tuple([Var("c"),NoAnnoList(List([Var("cs"),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("inner-boxes"),NoAnnoList(List([NoAnnoList(Op("S",[Var("sep")]))]))])))]))])))),Assign(Var("result"),NoAnnoList(List([Var("box-with-sep")]))))),Seq(Assign(Var("result'"),NoAnnoList(List([App(Seq(CallNoArgs(SVar("last")),CallT(SVar("add-sep"),[],[Var("sep")])),Var("boxes"))]))),Assign(Var("result"),App(Call(SVar("at-last"),[Build(Var("result'"))]),Var("boxes"))))))),RDefT("add-sep",[],[DefaultVarDec("sep")],Rule(NoAnnoList(Op("H",[Var("options"),Var("boxes")])),NoAnnoList(Op("H",[Var("options"),Var("result")])),Assign(Var("result"),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("boxes"),NoAnnoList(List([NoAnnoList(Op("S",[Var("sep")]))]))])))))),RDefT("add-sep",[],[DefaultVarDec("sep")],Rule(NoAnnoList(Op("I",[Var("is"),NoAnnoList(Op("H",[Var("hs"),Var("boxes")]))])),NoAnnoList(Op("I",[Var("is"),NoAnnoList(Op("H",[Var("hs"),Var("result")]))])),Assign(Var("result"),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("boxes"),NoAnnoList(List([NoAnnoList(Op("S",[Var("sep")]))]))])))))),RDefT("add-sep",[],[DefaultVarDec("sep")],Rule(NoAnnoList(Op("HV",[Var("hs"),Var("boxes")])),NoAnnoList(Op("HV",[Var("hs"),Var("result")])),Assign(Var("result"),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("boxes"),NoAnnoList(List([NoAnnoList(Op("S",[Var("sep")]))]))])))))),RDefT("add-sep",[],[DefaultVarDec("sep")],Rule(NoAnnoList(Op("HZ",[Var("hs"),Var("boxes")])),NoAnnoList(Op("HV",[Var("hs"),Var("result")])),Assign(Var("result"),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("boxes"),NoAnnoList(List([NoAnnoList(Op("S",[Var("sep")]))]))])))))),RDefT("add-sep",[],[DefaultVarDec("sep")],Rule(NoAnnoList(Op("Z",[Var("hs"),Var("boxes")])),NoAnnoList(Op("HV",[Var("hs"),Var("result")])),Assign(Var("result"),App(CallNoArgs(SVar("conc")),NoAnnoList(Tuple([Var("boxes"),NoAnnoList(List([NoAnnoList(Op("S",[Var("sep")]))]))]))))))])])