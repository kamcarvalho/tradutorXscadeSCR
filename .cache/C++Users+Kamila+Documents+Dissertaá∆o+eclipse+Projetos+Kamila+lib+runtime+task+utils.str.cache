Module("runtime/task/utils",[Rules([SDef("oncetd-annos",[DefaultVarDec("s")],LChoice(CallNoArgs(SVar("s")),LChoice(Seq(CallNoArgs(SVar("has-annos")),Seq(CallNoArgs(SVar("get-annos")),One(Call(SVar("oncetd-annos"),[CallNoArgs(SVar("s"))])))),One(Call(SVar("oncetd-annos"),[CallNoArgs(SVar("s"))]))))),SDef("collect-one-annos",[DefaultVarDec("s")],Seq(Call(SVar("oncetd-annos"),[Seq(CallNoArgs(SVar("s")),Match(Var("t")))]),Build(Var("t")))),RDef("crush-annos",[DefaultVarDec("nul"),DefaultVarDec("sum"),DefaultVarDec("s")],Rule(AnnoList(Explode(Wld,Var("xs")),[Var(ListVar("a*"))]),Var("r2"),Seq(Assign(Var("r1"),App(Call(SVar("foldr"),[CallNoArgs(SVar("nul")),CallNoArgs(SVar("sum")),CallNoArgs(SVar("s"))]),Var("xs"))),Assign(Var("r2"),App(Call(SVar("foldr"),[Build(Var("r1")),CallNoArgs(SVar("sum")),CallNoArgs(SVar("s"))]),Var(ListVar("a*"))))))),SDef("collect-all-annos",[DefaultVarDec("s"),DefaultVarDec("un")],LChoice(Build(NoAnnoList(ListTail([RootApp(CallNoArgs(SVar("s")))],RootApp(Call(SVar("crush-annos"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),Call(SVar("collect-all-annos"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("un"))])]))))),Call(SVar("crush-annos"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),Call(SVar("collect-all-annos"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("un"))])]))),RDef("crush-annos-2",[DefaultVarDec("nul"),DefaultVarDec("un"),DefaultVarDec("s"),DefaultVarDec("sa")],Rule(AnnoList(Explode(Wld,Var("xs")),[Var(ListVar("a*"))]),Var("r2"),Seq(Assign(Var("r1"),App(Call(SVar("foldr"),[CallNoArgs(SVar("nul")),CallNoArgs(SVar("un")),Call(SVar("collect-all-annos-2"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("un"))])]),Var("xs"))),Assign(Var("r2"),App(Call(SVar("foldr"),[Build(Var("r1")),CallNoArgs(SVar("un")),Call(SVar("collect-all-annos-2"),[CallNoArgs(SVar("sa")),CallNoArgs(SVar("un"))])]),Var(ListVar("a*"))))))),RDef("crush-annos-2",[DefaultVarDec("nul"),DefaultVarDec("un"),DefaultVarDec("s")],Rule(AnnoList(Explode(Wld,Var("xs")),[Var(ListVar("a*"))]),Var("r2"),Seq(Assign(Var("r1"),App(Call(SVar("foldr"),[CallNoArgs(SVar("nul")),CallNoArgs(SVar("un")),Call(SVar("collect-all-annos-2"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("un"))])]),Var("xs"))),Assign(Var("r2"),App(Call(SVar("foldr"),[Build(Var("r1")),CallNoArgs(SVar("un")),Call(SVar("collect-all-annos-2"),[CallNoArgs(SVar("s")),CallNoArgs(SVar("un"))])]),Var(ListVar("a*"))))))),SDef("collect-all-annos-2",[DefaultVarDec("s"),DefaultVarDec("sa"),DefaultVarDec("un")],LChoice(Build(NoAnnoList(ListTail([RootApp(CallNoArgs(SVar("s")))],RootApp(Call(SVar("crush-annos-2"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("s")),CallNoArgs(SVar("sa"))]))))),Call(SVar("crush-annos-2"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("s"))]))),SDef("collect-all-annos-2",[DefaultVarDec("s"),DefaultVarDec("un")],LChoice(Build(NoAnnoList(ListTail([RootApp(CallNoArgs(SVar("s")))],RootApp(Call(SVar("crush-annos-2"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("s"))]))))),Call(SVar("crush-annos-2"),[Build(NoAnnoList(List([]))),CallNoArgs(SVar("un")),CallNoArgs(SVar("s"))])))]),Rules([SDef("topdown-annos",[DefaultVarDec("s")],SwitchChoice(Id,[SwitchCase(AM(CallNoArgs(SVar("has-annos")),Var("t")),Seq(Build(NoAnnoList(Tuple([App(Seq(CallNoArgs(SVar("s")),All(Call(SVar("topdown-annos"),[CallNoArgs(SVar("s"))]))),Var("t")),App(Seq(CallNoArgs(SVar("get-annos")),Seq(CallNoArgs(SVar("s")),All(Call(SVar("topdown-annos"),[CallNoArgs(SVar("s"))])))),Var("t"))]))),CallNoArgs(SVar("set-annos"))))],Seq(CallNoArgs(SVar("s")),All(Call(SVar("topdown-annos"),[CallNoArgs(SVar("s"))])))))])])