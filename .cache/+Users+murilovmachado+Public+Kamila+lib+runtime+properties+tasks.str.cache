Module("runtime/properties/tasks",[Imports([Import("runtime/nabl/incremental"),Import("runtime/nabl/uri"),Import("runtime/properties/query"),Import("runtime/properties/eq"),Import("runtime/task/core"),Import("runtime/task/create"),Import("runtime/editor/annotations")]),Signature([Constructors([OpDecl("PropsLookup",FunType([ConstType(SortNoArgs("Property")),ConstType(SortNoArgs("URI"))],ConstType(SortNoArgs("Instruction")))),OpDecl("PropCheck",FunType([ConstType(SortNoArgs("Property")),ConstType(SortNoArgs("Relation")),ConstType(SortNoArgs("Term")),ConstType(SortNoArgs("Term"))],ConstType(SortNoArgs("Instruction")))),OpDecl("PropExtract",FunType([ConstType(SortNoArgs("Property")),ConstType(SortNoArgs("Term"))],ConstType(SortNoArgs("Instruction"))))])]),Rules([RDefT("prop-create-lookup",[],[DefaultVarDec("ctx"),DefaultVarDec("kind")],RuleNoCond(Var("contains-uri"),App(CallT(SVar("new-task"),[],[Var("ctx")]),NoAnnoList(Op("PropsLookup",[Var("kind"),Var("contains-uri")]))))),RDefT("perform-task",[],[DefaultVarDec("n")],Rule(NoAnnoList(Op("PropsLookup",[Var("kind"),Var("contains-uri")])),Var("res"),Seq(Assign(Var("uri"),App(CallNoArgs(SVar("nabl-uri")),Var("contains-uri"))),Seq(BA(CallT(SVar("nabl-add-uri-read"),[],[Var("n")]),Var("uri")),Seq(Assign(Var("val"),App(CallT(SVar("get-index-properties"),[],[Var("kind")]),Var("uri"))),Assign(Var("res"),App(Call(SVar("try"),[CallNoArgs(SVar("concat"))]),Var("val")))))))),RDefT("perform-cyclic-task",[],[DefaultVarDec("n")],Rule(NoAnnoList(Op("PropsLookup",[Var("kind"),Var("contains-uri")])),Var("res"),Seq(Assign(Var("uri"),App(CallNoArgs(SVar("nabl-uri")),Var("contains-uri"))),Seq(BA(CallT(SVar("nabl-add-uri-read"),[],[Var("n")]),Var("uri")),Seq(Assign(Var("val"),App(CallT(SVar("get-index-properties"),[],[Var("kind")]),Var("uri"))),Assign(Var("res"),App(Seq(Call(SVar("try"),[CallNoArgs(SVar("concat"))]),CallNoArgs(SVar("make-set"))),Var("val"))))))))]),Rules([RDefT("prop-create-check",[],[DefaultVarDec("ctx"),DefaultVarDec("kind"),DefaultVarDec("rel"),DefaultVarDec("actual")],RuleNoCond(Var("expected"),App(CallT(SVar("new-task"),[],[Var("ctx")]),NoAnnoList(Op("PropCheck",[Var("kind"),Var("rel"),Var("actual"),Var("expected")]))))),RDefT("perform-task",[],[DefaultVarDec("n")],RuleNoCond(NoAnnoList(Op("PropCheck",[Var("kind"),Var("rel"),Var("actual"),Var("expected")])),NoAnnoList(List([App(CallNoArgs(SVar("nabl-property-eq")),NoAnnoList(Tuple([Var("kind"),Var("rel"),NoAnnoList(Tuple([Var("actual"),Var("expected")]))])))]))))]),Rules([RDefT("prop-create-extract",[],[DefaultVarDec("ctx"),DefaultVarDec("kind")],RuleNoCond(Var("term"),App(CallT(SVar("new-task"),[],[Var("ctx")]),NoAnnoList(Op("PropExtract",[Var("kind"),Var("term")]))))),RDefT("perform-task",[],[DefaultVarDec("n")],Rule(NoAnnoList(Op("PropExtract",[Var("kind"),Var("term")])),Var("result"),LChoice(Assign(Var("result"),App(Call(SVar("get-annotation"),[Match(NoAnnoList(Tuple([Var("kind"),RootApp(Id)])))]),Var("term"))),Assign(Var("result"),App(CallT(SVar("perform-task"),[],[Var("n")]),NoAnnoList(Op("PropsLookup",[Var("kind"),Var("term")])))))))])])