Module("runtime/editor/properties",[Imports([Import("libstratego-gpp"),Import("runtime/editor/interop"),Import("runtime/index/core"),Import("runtime/nabl/collect"),Import("runtime/nabl/entries"),Import("runtime/nabl/uri"),Import("runtime/properties/collect"),Import("runtime/properties/query"),Import("runtime/task/core"),Import("runtime/types/query"),Import("runtime/types/collect")]),Rules([SDefT("get-editor-properties",[DefaultVarDec("language-pp")],[DefaultVarDec("language"),DefaultVarDec("project-path")],Seq(CallT(SVar("get-all-editor-properties"),[CallNoArgs(SVar("language-pp"))],[Var("language"),Var("project-path")]),Call(SVar("filter"),[CallNoArgs(SVar("not-none"))]))),RDefT("get-all-editor-properties",[DefaultVarDec("language-pp")],[DefaultVarDec("language"),DefaultVarDec("project-path")],Rule(Var("t"),App(Seq(CallNoArgs(SVar("concat")),Call(SVar("map"),[LRule(RuleNoCond(NoAnnoList(Tuple([Var("a"),Var("b")])),NoAnnoList(Tuple([Var("a"),App(CallNoArgs(SVar("pp-property")),Var("b"))]))))])),NoAnnoList(List([NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Str("\"Target\"")),App(Call(SVar("target-prop"),[CallNoArgs(SVar("language-pp"))]),Var("t"))])),NoAnnoList(Tuple([NoAnnoList(Str("\"Target Constructor\"")),App(CallNoArgs(SVar("cons-prop")),Var("t"))])),NoAnnoList(Tuple([NoAnnoList(Str("\"Name\"")),App(CallNoArgs(SVar("name-prop")),Var("t"))])),NoAnnoList(Tuple([NoAnnoList(Str("\"Defines\"")),App(CallNoArgs(SVar("def-prop")),Var("t"))])),NoAnnoList(Tuple([NoAnnoList(Str("\"Refers to\"")),App(CallNoArgs(SVar("ref-prop")),Var("t"))]))])),App(CallNoArgs(SVar("nabl-props")),Var("t"))]))),[WithClause(Seq(CallT(SVar("index-setup"),[],[Var("language"),Var("project-path")]),CallT(SVar("task-setup"),[],[Var("project-path")])))])),RDef("target-prop",[DefaultVarDec("language-pp")],Rule(Var("t"),Var("tar"),[WithClause(LChoice(Assign(Var("tar"),App(Call(SVar("pp-ast"),[CallNoArgs(SVar("language-pp"))]),Var("t"))),Assign(Var("tar"),NoAnnoList(Op("None",[])))))])),RDefNoArgs("cons-prop",Rule(Wld,NoAnnoList(Op("None",[])),CallNoArgs(SVar("is-string")))),RDefNoArgs("cons-prop",Rule(Var("t"),Var("constr"),[WhereClause(Not(CallNoArgs(SVar("is-string")))),WithClause(LChoice(Assign(Var("constr"),App(CallNoArgs(SVar("pp-cons")),Var("t"))),Assign(Var("constr"),NoAnnoList(Op("None",[])))))])),RDefNoArgs("type-prop",Rule(Var("t"),Var("type"),[WithClause(LChoice(Assign(Var("type"),App(CallNoArgs(SVar("get-type")),Var("t"))),Assign(Var("type"),NoAnnoList(Op("None",[])))))])),RDefNoArgs("name-prop",Rule(Var("t"),Var("name"),LChoice(Assign(Var("name"),App(CallNoArgs(SVar("nabl-get-name")),Var("t"))),Assign(Var("name"),NoAnnoList(Op("None",[])))))),RDefNoArgs("def-prop",Rule(Var("t"),Var("uri"),[WithClause(LChoice(Assign(Var("uri"),App(Seq(CallNoArgs(SVar("nabl-collect-def")),Seq(CallNoArgs(SVar("nabl-uri")),CallNoArgs(SVar("pp-uri")))),Var("t"))),Assign(Var("uri"),NoAnnoList(Op("None",[])))))])),RDefNoArgs("ref-prop",RuleNoCond(NoAnnoList(Op("Def",[Var("uri")])),App(CallNoArgs(SVar("pp-uri")),Var("uri")))),RDefNoArgs("ref-prop",Rule(Var("t"),Var("uri"),[WithClause(LChoice(Assign(Var("uri"),App(Seq(CallNoArgs(SVar("nabl-collect-use")),Seq(CallNoArgs(SVar("nabl-uri")),CallNoArgs(SVar("pp-uri")))),Var("t"))),Assign(Var("uri"),NoAnnoList(Op("None",[])))))])),RDefNoArgs("nabl-props",Rule(Var("t"),Var("props"),[WithClause(Assign(Var("nabl-props"),NoAnnoList(ListTail([NoAnnoList(Op("Type",[]))],RootApp(CallNoArgs(SVar("nabl-collect-custom-properties"))))))),WithClause(LChoice(Assign(Var("props"),App(Call(SVar("map"),[CallT(SVar("nabl-prop"),[],[Var("t")])]),Var("nabl-props"))),Assign(Var("props"),NoAnnoList(List([])))))])),RDefT("nabl-prop",[],[DefaultVarDec("t")],RuleNoCond(Var("p"),App(CallNoArgs(SVar("nabl-prop")),NoAnnoList(Tuple([Var("t"),Var("p")]))))),RDefNoArgs("nabl-prop",Rule(NoAnnoList(Tuple([Var("t"),Var("property")])),NoAnnoList(Tuple([Var("name"),Var("prop")])),[WithClause(Assign(Var("name"),App(CallNoArgs(SVar("pp-nabl-prop-name")),Var("property")))),WithClause(LChoice(Assign(Var("prop"),App(Seq(CallT(SVar("get-properties"),[],[Var("property")]),Seq(CallNoArgs(SVar("de-list")),Not(Seq(Match(NoAnnoList(Op("Result",[Wld]))),CallNoArgs(SVar("task-has-failed")))))),Var("t"))),LChoice(Assign(Var("prop"),App(Seq(CallT(SVar("get-property"),[],[Var("property")]),Not(Seq(Match(NoAnnoList(Op("Result",[Wld]))),CallNoArgs(SVar("task-has-failed"))))),Var("t"))),Assign(Var("prop"),NoAnnoList(Op("None",[]))))))]))]),Rules([RDefNoArgs("not-none",Rule(NoAnnoList(Tuple([Var("a"),Var("b")])),NoAnnoList(Tuple([Var("a"),Var("b")])),Seq(BA(Not(CallNoArgs(SVar("eq"))),NoAnnoList(Tuple([Var("b"),NoAnnoList(Op("None",[]))]))),BA(Not(CallNoArgs(SVar("eq"))),NoAnnoList(Tuple([Var("b"),NoAnnoList(Str("\"-\""))])))))),RDefNoArgs("de-list",RuleNoCond(NoAnnoList(List([])),NoAnnoList(Op("None",[])))),RDefNoArgs("de-list",RuleNoCond(NoAnnoList(List([Var("a")])),Var("a"))),RDefNoArgs("de-list",RuleNoCond(NoAnnoList(ListTail([Var("a")],Var("rest"))),NoAnnoList(ListTail([Var("a")],Var("rest")))))]),Rules([SDef("pp-ast",[DefaultVarDec("language-pp")],Seq(Call(SVar("topdown"),[Call(SVar("try"),[CallNoArgs(SVar("rm-annotations"))])]),CallNoArgs(SVar("language-pp")))),RDefNoArgs("pp-cons",RuleNoCond(Var("t"),NoAnnoList(StringQuotation1("                  ",[StringEscape1("                  ",App(CallNoArgs(SVar("get-constructor")),Var("t"))),QStr("/"),StringEscape1("                                        ",App(Seq(CallNoArgs(SVar("get-arguments")),CallNoArgs(SVar("length"))),Var("t")))])))),SDefNoArgs("pp-uri",Seq(CallNoArgs(SVar("reverse-uri")),Seq(CallT(SVar("foreign-call"),[],[NoAnnoList(Str("\"Analysis\"")),NoAnnoList(Str("\"make-abstract\""))]),Seq(CallT(SVar("foreign-call"),[],[NoAnnoList(Str("\"Analysis\"")),NoAnnoList(Str("\"prettyprint-example\""))]),CallT(SVar("box2text-string"),[],[NoAnnoList(Int("80"))]))))),RDefNoArgs("reverse-uri",RuleNoCond(NoAnnoList(Op("URI",[Var("language"),Var("uri")])),NoAnnoList(Op("URI",[Var("language"),App(CallNoArgs(SVar("reverse")),Var("uri"))])))),RDefNoArgs("pp-nabl-prop-name",RuleNoCond(NoAnnoList(Op("Type",[])),NoAnnoList(Str("\"Type\"")))),SDefNoArgs("pp-nabl-prop-name",Seq(CallNoArgs(SVar("write-to-string")),Seq(CallT(SVar("string-replace"),[],[NoAnnoList(Str("\"NablProp_\"")),NoAnnoList(Str("\"\""))]),Seq(CallT(SVar("string-replace"),[],[NoAnnoList(Str("\"-\"")),NoAnnoList(Str("\" \""))]),CallNoArgs(SVar("upper-case-first")))))),RDefNoArgs("upper-case-first",Rule(Var("string"),App(CallNoArgs(SVar("implode-string")),NoAnnoList(ListTail([App(CallNoArgs(SVar("to-upper")),Var("c"))],Var("hars")))),[WithClause(Assign(NoAnnoList(ListTail([Var("c")],Var("hars"))),App(CallNoArgs(SVar("explode-string")),Var("string"))))])),RDefNoArgs("pp-property",Rule(Var("a"),Var("a"),CallNoArgs(SVar("is-string")))),RDefNoArgs("pp-property",RuleNoCond(NoAnnoList(Op("None",[])),NoAnnoList(Str("\"-\"")))),RDefNoArgs("pp-property",Rule(Var("a"),App(Call(SVar("map"),[Seq(CallNoArgs(SVar("pp-property")),LRule(RuleNoCond(Var("x"),NoAnnoList(Tuple([NoAnnoList(Str("\"\"")),Var("x")])))))]),Var("a")),CallNoArgs(SVar("is-list")))),RDefNoArgs("pp-property",RuleNoCond(NoAnnoList(Op("Def",[Var("uri")])),App(CallNoArgs(SVar("pp-uri")),Var("uri")))),SDefNoArgs("pp-property",Seq(Call(SVar("topdown"),[Call(SVar("try"),[CallNoArgs(SVar("rm-annotations"))])]),CallNoArgs(SVar("write-to-string"))))]),Rules([SDefNoArgs("properties-to-html",Seq(Call(SVar("map"),[CallNoArgs(SVar("property-to-html"))]),Seq(CallT(SVar("separate-by"),[],[NoAnnoList(Str("\"<br/>\\n\""))]),CallNoArgs(SVar("concat-strings"))))),RDefNoArgs("property-to-html",RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Str("\"\"")),Var("prop")])),NoAnnoList(StringQuotation1("                                    ",[StringEscape1("                                    ",App(CallNoArgs(SVar("property-to-html")),Var("prop")))])))),RDefNoArgs("property-to-html",RuleNoCond(NoAnnoList(Tuple([Var("name"),Var("prop")])),NoAnnoList(StringQuotation1("                                      ",[QStr("<b>"),StringEscape1("                                         ",Var("name")),QStr("</b>: "),StringEscape1("                                                     ",App(CallNoArgs(SVar("property-to-html")),Var("prop")))])))),RDefNoArgs("property-to-html",Rule(Var("list"),NoAnnoList(StringQuotation1("                              ",[QStr("<div>"),StringEscape1("                                   ",App(CallNoArgs(SVar("properties-to-html")),Var("list"))),QStr("</div>")])),CallNoArgs(SVar("is-list")))),RDefNoArgs("property-to-html",RuleNoCond(Var("prop"),App(CallNoArgs(SVar("escape-for-html")),NoAnnoList(StringQuotation1("                                                ",[StringEscape1("                                                ",Var("prop"))]))))),SDefNoArgs("escape-for-html",Seq(CallT(SVar("string-replace"),[],[NoAnnoList(Str("\"&\"")),NoAnnoList(Str("\"&amp;\""))]),Seq(CallT(SVar("string-replace"),[],[NoAnnoList(Str("\"<\"")),NoAnnoList(Str("\"&lt;\""))]),Seq(CallT(SVar("string-replace"),[],[NoAnnoList(Str("\">\"")),NoAnnoList(Str("\"&gt;\""))]),CallT(SVar("string-replace"),[],[NoAnnoList(Str("\"\\n\"")),NoAnnoList(Str("\"<br/>\""))])))))])])